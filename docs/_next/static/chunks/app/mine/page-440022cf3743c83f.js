(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[933],{6270:function(e,t,a){Promise.resolve().then(a.bind(a,6582))},6582:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ex}});var n=a(7437),r=a(6900),s=a(6070),l=a(2869),o=a(2660),i=a(9322),c=a(1804),d=a(7168),m=a(6399),u=a(9232),g=a(5805),h=a(7414),p=a(7648),f=a(2265),x=a(7593),b=a(6366);let y=(0,f.createContext)(void 0);function w(e){let{children:t}=e,[a,r]=(0,f.useState)(!1),[s,l]=(0,f.useState)(null),[o,i]=(0,f.useState)(null),[c,d]=(0,f.useState)(null),[m,u]=(0,f.useState)(null),{networkConfig:g,isNetworkSupported:h,getNetworkByChainId:p}=(0,b.L)(),w=async()=>{try{if(u(null),void 0===window.ethereum)throw Error("MetaMask is not installed. Please install MetaMask to continue.");await window.ethereum.request({method:"eth_requestAccounts"});let e=new x.Q(window.ethereum),t=await e.getSigner(),a=await t.getAddress(),n=await e.getNetwork();if("0x".concat(n.chainId.toString(16))!==g.chainId)try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:g.chainId}]})}catch(e){if(4902===e.code){if("Anvil Local"!==g.chainName)await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:g.chainId,chainName:g.chainName,nativeCurrency:g.nativeCurrency,rpcUrls:g.rpcUrls,blockExplorerUrls:g.blockExplorerUrls}]});else throw Error("Please start your local Anvil node and add the network manually")}else throw e}i(e),d(t),l(a),r(!0),console.log("[v0] Wallet connected:",a)}catch(e){console.error("[v0] Wallet connection error:",e),u(e.message||"Failed to connect wallet"),r(!1),l(null),i(null),d(null)}},v=()=>{r(!1),l(null),i(null),d(null),u(null),console.log("[v0] Wallet disconnected")},N=async()=>{if(void 0!==window.ethereum&&a)try{let e=new x.Q(window.ethereum),t=await e.getSigner();i(e),d(t),console.log("[v0] Provider updated for network change")}catch(e){console.error("[v0] Error updating provider:",e)}};return(0,f.useEffect)(()=>{if(void 0!==window.ethereum){let e=e=>{0===e.length?v():e[0]!==s&&w()},t=async e=>{console.log("[v0] Network changed to:",e),p(e)?await N():(u("Unsupported network. Please switch to Sepolia or Anvil."),v())};return window.ethereum.on("accountsChanged",e),window.ethereum.on("chainChanged",t),()=>{window.ethereum.removeListener("accountsChanged",e),window.ethereum.removeListener("chainChanged",t)}}},[s,p,a]),(0,f.useEffect)(()=>{(async()=>{if(void 0!==window.ethereum)try{(await window.ethereum.request({method:"eth_accounts"})).length>0&&await w()}catch(e){console.error("[v0] Error checking wallet connection:",e)}})()},[g]),(0,n.jsx)(y.Provider,{value:{isConnected:a,address:s,provider:o,signer:c,connectWallet:w,disconnectWallet:v,error:m},children:t})}function v(){let e=(0,f.useContext)(y);if(void 0===e)throw Error("useWallet must be used within a WalletProvider");return e}var N=a(3032),j=a(407),E=a(401),S=a(519),C=a(4508);let k=N.fC,A=N.xz;N.ZA,N.Uv,N.Tr,N.Ee,f.forwardRef((e,t)=>{let{className:a,inset:r,children:s,...l}=e;return(0,n.jsxs)(N.fF,{ref:t,className:(0,C.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...l,children:[s,(0,n.jsx)(j.Z,{className:"ml-auto"})]})}).displayName=N.fF.displayName,f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(N.tu,{ref:t,className:(0,C.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=N.tu.displayName;let B=f.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...s}=e;return(0,n.jsx)(N.Uv,{children:(0,n.jsx)(N.VY,{ref:t,sideOffset:r,className:(0,C.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})})});B.displayName=N.VY.displayName;let F=f.forwardRef((e,t)=>{let{className:a,inset:r,...s}=e;return(0,n.jsx)(N.ck,{ref:t,className:(0,C.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...s})});F.displayName=N.ck.displayName,f.forwardRef((e,t)=>{let{className:a,children:r,checked:s,...l}=e;return(0,n.jsxs)(N.oC,{ref:t,className:(0,C.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:s,...l,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(N.wU,{children:(0,n.jsx)(E.Z,{className:"h-4 w-4"})})}),r]})}).displayName=N.oC.displayName,f.forwardRef((e,t)=>{let{className:a,children:r,...s}=e;return(0,n.jsxs)(N.Rk,{ref:t,className:(0,C.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(N.wU,{children:(0,n.jsx)(S.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=N.Rk.displayName,f.forwardRef((e,t)=>{let{className:a,inset:r,...s}=e;return(0,n.jsx)(N.__,{ref:t,className:(0,C.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...s})}).displayName=N.__.displayName,f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(N.Z0,{ref:t,className:(0,C.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=N.Z0.displayName;var T=a(9202),R=a(1239),M=a(875);let I={sepolia:{name:"Sepolia",icon:(0,n.jsx)(T.Z,{className:"w-4 h-4"}),color:"text-blue-400"},anvil:{name:"Anvil",icon:(0,n.jsx)(R.Z,{className:"w-4 h-4"}),color:"text-orange-400"}};function Z(){let{selectedNetwork:e,switchNetwork:t}=(0,b.L)(),[a,r]=(0,f.useState)(null),s=async a=>{if(a!==e){r(a);try{await t(a)}catch(e){console.error("Failed to switch network:",e)}finally{r(null)}}},o=I[e];return(0,n.jsxs)(k,{children:[(0,n.jsx)(A,{asChild:!0,children:(0,n.jsx)(l.z,{variant:"outline",size:"sm",className:"bg-gray-900/50 border-gray-700 text-gray-300 hover:bg-gray-800/50",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:o.color,children:o.icon}),(0,n.jsx)("span",{className:"hidden sm:inline",children:o.name}),(0,n.jsx)(M.Z,{className:"w-3 h-3"})]})})}),(0,n.jsx)(B,{align:"end",className:"bg-gray-900 border-gray-700",children:Object.entries(I).map(t=>{let[r,l]=t;return(0,n.jsx)(F,{onClick:()=>s(r),disabled:a===r,className:"text-gray-300 hover:bg-gray-800 focus:bg-gray-800",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:l.color,children:l.icon}),(0,n.jsx)("span",{children:l.name}),e===r&&(0,n.jsx)("div",{className:"ml-auto w-2 h-2 bg-green-400 rounded-full"}),a===r&&(0,n.jsx)("div",{className:"ml-auto w-3 h-3 border border-gray-400 border-t-transparent rounded-full animate-spin"})]})},r)})})]})}var z=a(5810),O=a(1662),_=a(6110);let P=f.forwardRef((e,t)=>{let{className:a,type:r,...s}=e;return(0,n.jsx)("input",{type:r,className:(0,C.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});P.displayName="Input";var H=a(6394),W=a(535);let U=(0,W.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),q=f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(H.f,{ref:t,className:(0,C.cn)(U(),a),...r})});q.displayName=H.f.displayName;var G=a(3618);function L(){let[e,t]=(0,f.useState)(null),[a,n]=(0,f.useState)(null),[r,s]=(0,f.useState)(null),[l,o]=(0,f.useState)(!1),i=(0,f.useCallback)(async t=>{if(t.length>0){if(e)try{let a=await e.getSigner();n(a),s(t[0]),o(!0)}catch(e){console.error("Failed to get signer:",e)}}else s(null),n(null),o(!1)},[e]);(0,f.useEffect)(()=>{(async()=>{if(window.ethereum){let e=new x.Q(window.ethereum);t(e);try{if((await e.listAccounts()).length>0){let t=await e.getSigner();n(t),s(await t.getAddress()),o(!0)}}catch(e){console.error("Failed to get accounts:",e)}}})()},[]),(0,f.useEffect)(()=>{if(window.ethereum&&i)return window.ethereum.on("accountsChanged",i),()=>{window.ethereum.removeAllListeners("accountsChanged")}},[i]);let c=async()=>{if(e)try{await e.send("eth_requestAccounts",[]);let t=await e.getSigner();n(t),s(await t.getAddress()),o(!0)}catch(e){console.error("Failed to connect:",e)}};return{provider:e,signer:a,address:r,isConnected:l,connect:c}}function V(e,t){let{provider:a,signer:n}=L(),[r,s]=(0,f.useState)(null);(0,f.useEffect)(()=>{a&&e&&t&&s(new z.CH(e,t,n||a))},[a,n,e]);let l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!r)return null;try{return await r[e](...t)}catch(t){var a;if((null==t?void 0:t.code)==="NETWORK_ERROR"&&(null==t?void 0:null===(a=t.message)||void 0===a?void 0:a.includes("network changed")))return console.log("[v0] Network changed during ".concat(e," call, ignoring error")),null;return console.error("Error calling ".concat(e,":"),t),null}},o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!r||!n)return null;try{let a;console.log("[v0] Attempting ".concat(e," with args:"),t);let s=await n.provider.getNetwork(),l=31337n===s.chainId||1337n===s.chainId;try{let n=await r[e].estimateGas(...t);console.log("[v0] Estimated gas for ".concat(e,":"),n.toString()),a=l?150n*n/100n:120n*n/100n,console.log("[v0] Using gas limit for ".concat(e,":"),a.toString())}catch(t){console.warn("[v0] Gas estimation failed for ".concat(e,":"),t),a=l?500000n:300000n,console.log("[v0] Using fallback gas limit for ".concat(e,":"),a.toString())}let o=await r[e](...t,{gasLimit:a});return console.log("[v0] ".concat(e," transaction sent:"),o.hash),o}catch(n){var a;if(console.error("[v0] Error calling ".concat(e,":"),n),(null==n?void 0:n.code)===-32603||(null==n?void 0:null===(a=n.message)||void 0===a?void 0:a.includes("Internal JSON-RPC error"))){console.log("[v0] RPC error calling ".concat(e,", trying alternative approach"));try{let a=await r[e](...t,{gasLimit:800000n,type:0});return console.log("[v0] Alternative approach succeeded:",a.hash),a}catch(a){console.error("[v0] Alternative approach also failed for ".concat(e,":"),a);try{console.log("[v0] Trying ".concat(e," with no gas options as final fallback"));let a=await r[e](...t);return console.log("[v0] No-gas-options approach succeeded:",a.hash),a}catch(t){throw console.error("[v0] All approaches failed for ".concat(e,":"),t),t}}}throw n}};return{contract:r,readContract:l,writeContract:o}}function K(e){let{children:t,bethBalance:a,currentEpoch:r}=e,[s,o]=(0,f.useState)(!1),[c,d]=(0,f.useState)(""),[m,u]=(0,f.useState)(""),[g,h]=(0,f.useState)(!1),[p,x]=(0,f.useState)(null),[y,w]=(0,f.useState)(!1),[v,N]=(0,f.useState)(!1),{address:j}=L(),{networkConfig:E}=(0,b.L)(),{readContract:S,writeContract:C}=V(E.contracts.worm,[{name:"approximate",type:"function",stateMutability:"view",inputs:[{name:"_amountPerEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{name:"participate",type:"function",stateMutability:"nonpayable",inputs:[{name:"_amountPerEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"}],outputs:[]}]),{readContract:k,writeContract:A}=V(E.contracts.beth,[{name:"allowance",type:"function",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"approve",type:"function",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{name:"balanceOf",type:"function",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"name",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"string"}]},{name:"symbol",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"string"}]},{name:"decimals",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"uint8"}]},{name:"totalSupply",type:"function",stateMutability:"view",inputs:[],outputs:[{name:"",type:"uint256"}]}]),B=(Number.parseFloat(c)||0)*(Number.parseFloat(m)||0),F=B<=(Number.parseFloat(a)||0),T=c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0;(0,f.useEffect)(()=>{let e=new AbortController;return(async()=>{if(c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0&&j&&E.contracts.worm)try{if(e.signal.aborted)return;console.log("[v0] Calling approximate with:",{amountPerEpoch:Math.floor(1e18*(Number.parseFloat(m)||0)),numEpochs:Number.parseInt(c)||0,contractAddress:E.contracts.worm,userAddress:j});let t=await S("approximate",[BigInt(Math.floor(1e18*(Number.parseFloat(m)||0))),BigInt(Number.parseInt(c)||0)]);if(e.signal.aborted)return;console.log("[v0] Approximate result:",t),x(t)}catch(a){var t;(null==a?void 0:a.code)==="NETWORK_ERROR"&&(null==a?void 0:null===(t=a.message)||void 0===t?void 0:t.includes("network changed"))||console.error("[v0] Error fetching approximate WORM amount:",a),e.signal.aborted||x(null)}else console.log("[v0] Not fetching amount - conditions not met:",{isValid:!!(c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0),hasAddress:!!j,hasContractAddress:!!E.contracts.worm}),x(null)})(),()=>{e.abort()}},[c,m,j,S,E.contracts.worm]),(0,f.useEffect)(()=>{(async()=>{if(j&&E.contracts.beth&&E.contracts.worm&&B>0)try{let e=await k("allowance",[j,E.contracts.worm]),t=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),a=e>=t/BigInt(2),n=BigInt(Math.floor(1e18*B));w(!a&&e<n)}catch(e){console.error("[v0] Error checking allowance:",e),w(!0)}else w(!1)})()},[j,E.contracts.beth,E.contracts.worm,B,k]);let R=async()=>{if(j&&E.contracts.worm){N(!0);try{let e=BigInt("1000000000000000000000000");console.log("[v0] Approving large BETH spend:",{spender:E.contracts.worm,amount:e.toString()});let t=await A("approve",[E.contracts.worm,e]);console.log("[v0] Approval transaction sent:",t.hash),await t.wait(),console.log("[v0] Approval transaction confirmed"),w(!1)}catch(e){console.error("[v0] Approval error:",e)}finally{N(!1)}}},M=async()=>{if(T&&!y){h(!0);try{console.log("[v0] Participating:",{numEpochs:c,bethPerEpoch:m,totalBeth:B});let e=BigInt(Math.floor(1e18*(Number.parseFloat(m)||0))),t=BigInt(Number.parseInt(c)||0);console.log("[v0] Calling participate with:",{amountPerEpoch:e.toString(),numEpochs:t.toString()});let a=await C("participate",[e,t]);console.log("[v0] Participate transaction sent:",a.hash),await a.wait(),console.log("[v0] Participate transaction confirmed"),o(!1),d(""),u("")}catch(e){console.error("[v0] Participate error:",e)}finally{h(!1)}}};return(0,n.jsxs)(_.Vq,{open:s,onOpenChange:o,children:[(0,n.jsx)(_.hg,{asChild:!0,children:t}),(0,n.jsxs)(_.cZ,{className:"bg-green-950/95 border-green-800 text-white",children:[(0,n.jsx)(_.fK,{children:(0,n.jsx)(_.$N,{className:"text-green-300",children:"Participate in Mining"})}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(q,{htmlFor:"numEpochs",className:"text-green-300",children:"Number of Epochs"}),(0,n.jsx)(P,{id:"numEpochs",type:"number",value:c,onChange:e=>d(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter number of epochs"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(q,{htmlFor:"bethPerEpoch",className:"text-green-300",children:"BETH per Epoch"}),(0,n.jsx)(P,{id:"bethPerEpoch",type:"number",step:"0.0001",value:m,onChange:e=>u(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter BETH amount per epoch"})]}),(0,n.jsxs)("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(G.Z,{className:"w-4 h-4 text-green-400"}),(0,n.jsx)("span",{className:"text-green-300 font-medium",children:"Total BETH Required"})]}),(0,n.jsxs)("div",{className:"text-2xl font-mono text-yellow-300",children:[B.toFixed(4)," BETH"]}),(0,n.jsxs)("div",{className:"text-sm text-gray-400",children:["Your Balance: ",a," BETH"]}),!F&&B>0&&(0,n.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-red-400",children:[(0,n.jsx)(i.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-sm",children:"Insufficient BETH balance"})]})]}),c&&m&&Number.parseFloat(c)>0&&Number.parseFloat(m)>0&&(0,n.jsxs)("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(G.Z,{className:"w-4 h-4 text-green-400"}),(0,n.jsx)("span",{className:"text-green-300 font-medium",children:"Approximate WORM Reward"})]}),(0,n.jsxs)("div",{className:"text-2xl font-mono text-yellow-300",children:[p?(Number(p)/1e18).toFixed(4):"Calculating..."," WORM"]}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:"Estimated based on current conditions"})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(l.z,{variant:"outline",onClick:()=>o(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800",children:"Cancel"}),y?(0,n.jsx)(l.z,{onClick:R,disabled:!T||!F||v,className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-semibold",children:v?"Approving...":"Approve BETH"}):(0,n.jsx)(l.z,{onClick:M,disabled:!T||!F||g,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:g?"Participating...":"Participate"})]})]})]})]})}function J(e){let{children:t,currentEpoch:a}=e,[r,s]=(0,f.useState)(!1),[o,c]=(0,f.useState)(""),[d,m]=(0,f.useState)(""),[u,g]=(0,f.useState)(!1),[h,p]=(0,f.useState)(null),{address:x}=L(),{networkConfig:y}=(0,b.L)(),{readContract:w,writeContract:v}=V(y.contracts.worm,[{name:"calculateMintAmount",type:"function",stateMutability:"view",inputs:[{name:"_startingEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"},{name:"_user",type:"address"}],outputs:[{name:"",type:"uint256"}]},{name:"claim",type:"function",stateMutability:"nonpayable",inputs:[{name:"_startingEpoch",type:"uint256"},{name:"_numEpochs",type:"uint256"}],outputs:[{name:"",type:"uint256"}]}]),N=Number.parseInt(o)||0,j=Number.parseInt(d)||0,E=N+j-1,S=N<a&&E<a,C=o&&d&&S;(0,f.useEffect)(()=>{(async()=>{if(C&&x&&y.contracts.worm)try{console.log("[v0] Calling calculateMintAmount with:",{startingEpoch:N,numEpochs:j,userAddress:x,contractAddress:y.contracts.worm});let e=await w("calculateMintAmount",[BigInt(N),BigInt(j),x]);console.log("[v0] calculateMintAmount result:",e),p(e)}catch(e){console.error("[v0] Error fetching expected WORM amount:",e),p(null)}else console.log("[v0] Not fetching amount - conditions not met:",{isValid:C,hasAddress:!!x,hasContractAddress:!!y.contracts.worm}),p(null)})()},[C,x,N,j,w,y.contracts.worm]);let k=async()=>{if(C){g(!0);try{console.log("[v0] Claiming:",{fromEpoch:o,numEpochs:d});let e=BigInt(N),t=BigInt(j);console.log("[v0] Calling claim with:",{startingEpoch:e.toString(),numEpochs:t.toString()});let a=await v("claim",[e,t]);console.log("[v0] Claim transaction sent:",a.hash),await a.wait(),console.log("[v0] Claim transaction confirmed"),s(!1),c(""),m("")}catch(e){console.error("[v0] Claim error:",e)}finally{g(!1)}}};return(0,n.jsxs)(_.Vq,{open:r,onOpenChange:s,children:[(0,n.jsx)(_.hg,{asChild:!0,children:t}),(0,n.jsxs)(_.cZ,{className:"bg-green-950/95 border-green-800 text-white",children:[(0,n.jsx)(_.fK,{children:(0,n.jsx)(_.$N,{className:"text-green-300",children:"Claim WORM Tokens"})}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(q,{htmlFor:"claimFromEpoch",className:"text-green-300",children:"From Epoch"}),(0,n.jsx)(P,{id:"claimFromEpoch",type:"number",value:o,onChange:e=>c(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter starting epoch",max:a-1})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(q,{htmlFor:"claimNumEpochs",className:"text-green-300",children:"Number of Epochs"}),(0,n.jsx)(P,{id:"claimNumEpochs",type:"number",value:d,onChange:e=>m(e.target.value),className:"bg-green-950/60 border-green-700 text-white",placeholder:"Enter number of epochs to claim"})]}),o&&d&&!S&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-red-400",children:[(0,n.jsx)(i.Z,{className:"w-4 h-4"}),(0,n.jsxs)("span",{className:"text-sm",children:["Can only claim completed epochs (current: ",a,", claiming: ",N,"-",E,")"]})]}),C&&null!==h&&(0,n.jsxs)("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(G.Z,{className:"w-4 h-4 text-green-400"}),(0,n.jsx)("span",{className:"text-green-300 font-medium",children:"Expected WORM Reward"})]}),(0,n.jsxs)("div",{className:"text-2xl font-mono text-yellow-300",children:[0n===h?"0.0000":(Number(h)/1e18).toFixed(4)," WORM"]}),(0,n.jsxs)("div",{className:"text-sm text-gray-400",children:["Claimable from epochs ",N," to ",E]}),0n===h&&(0,n.jsx)("div",{className:"text-sm text-orange-400 mt-2",children:"No WORM tokens available for these epochs. You may not have participated in mining during this period."})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(l.z,{variant:"outline",onClick:()=>s(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800",children:"Cancel"}),(0,n.jsx)(l.z,{onClick:k,disabled:!C||u,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:u?"Claiming...":"Claim"})]})]})]})]})}let Y=(0,W.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),$=f.forwardRef((e,t)=>{let{className:a,variant:r,...s}=e;return(0,n.jsx)("div",{ref:t,role:"alert",className:(0,C.cn)(Y({variant:r}),a),...s})});$.displayName="Alert",f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("h5",{ref:t,className:(0,C.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})}).displayName="AlertTitle";let D=f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,C.cn)("text-sm [&_p]:leading-relaxed",a),...r})});D.displayName="AlertDescription";var Q=a(1264),X=a(2135);let ee=Q.fC;Q.ZA;let et=Q.B4,ea=f.forwardRef((e,t)=>{let{className:a,children:r,...s}=e;return(0,n.jsxs)(Q.xz,{ref:t,className:(0,C.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[r,(0,n.jsx)(Q.JO,{asChild:!0,children:(0,n.jsx)(M.Z,{className:"h-4 w-4 opacity-50"})})]})});ea.displayName=Q.xz.displayName;let en=f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(Q.u_,{ref:t,className:(0,C.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,n.jsx)(X.Z,{className:"h-4 w-4"})})});en.displayName=Q.u_.displayName;let er=f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(Q.$G,{ref:t,className:(0,C.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,n.jsx)(M.Z,{className:"h-4 w-4"})})});er.displayName=Q.$G.displayName;let es=f.forwardRef((e,t)=>{let{className:a,children:r,position:s="popper",...l}=e;return(0,n.jsx)(Q.h_,{children:(0,n.jsxs)(Q.VY,{ref:t,className:(0,C.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...l,children:[(0,n.jsx)(en,{}),(0,n.jsx)(Q.l_,{className:(0,C.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,n.jsx)(er,{})]})})});es.displayName=Q.VY.displayName,f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(Q.__,{ref:t,className:(0,C.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=Q.__.displayName;let el=f.forwardRef((e,t)=>{let{className:a,children:r,...s}=e;return(0,n.jsxs)(Q.ck,{ref:t,className:(0,C.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(Q.wU,{children:(0,n.jsx)(E.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(Q.eT,{children:r})]})});el.displayName=Q.ck.displayName,f.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(Q.Z0,{ref:t,className:(0,C.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=Q.Z0.displayName;var eo=a(1817),ei=a(9397),ec=a(4882),ed=a(5938),em=a(135),eu=a(1489);let eg=BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),eh=BigInt("0xba44186ee7876b8007d2482cd46cec2d115b780980a6b46f0363f983d892f7e");function ep(e){var t,a;let{children:r,onBurnComplete:s}=e,{address:o,signer:i}=v(),[c,u]=(0,f.useState)(!1),[g,h]=(0,f.useState)([]),[p,x]=(0,f.useState)(!1),[b,y]=(0,f.useState)(0),[w,N]=(0,f.useState)(null),[j,E]=(0,f.useState)(null),[S,C]=(0,f.useState)(new Set),[k,A]=(0,f.useState)(!1),[B,F]=(0,f.useState)(""),[T,R]=(0,f.useState)(""),[M,I]=(0,f.useState)(!1),[Z,z]=(0,f.useState)(!1),[H,W]=(0,f.useState)(""),[U,G]=(0,f.useState)({stage:"confirm"}),[L,V]=(0,f.useState)("http://12.23.34.45:8000/prove"),K="burn-key-results-".concat(o),J=e=>{try{o&&localStorage.setItem(K,JSON.stringify(e))}catch(e){console.error("Failed to save to localStorage:",e)}},Y=()=>{try{if(!o)return[];let e=localStorage.getItem(K);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load from localStorage:",e),[]}};(0,f.useEffect)(()=>{if(o&&c){let e=Y();e.length>0&&(h(e),y(Math.max(...e.map(e=>e.index))+1))}},[o,c]);let Q=async(e,t)=>{if(i){C(e=>new Set(e).add(t));try{let a=i.provider,n=await a.getBalance(e),r=(0,O.dF)(n);h(e=>e.map(e=>e.index===t?{...e,balance:r}:e));let s=g.map(e=>e.index===t?{...e,balance:r}:e);J(s)}catch(e){console.error("Failed to fetch balance:",e)}finally{C(e=>{let a=new Set(e);return a.delete(t),a})}}};function X(e,t){let a=e.toString(16).padStart(2*t,"0"),n=new Uint8Array(t);for(let e=0;e<t;e++)n[e]=Number.parseInt(a.substr(2*e,2),16);return n}async function en(){if(!i)throw Error("Wallet not connected");if(null!==j)return j;let e=await i.signMessage("EIP-7503"),t=BigInt(ed.P.from(e).s)%eg;return E(t),t}async function er(e){x(!0),N(null);try{if(!i||!o)throw Error("Please connect your wallet first");let t=BigInt(0),a=function(e){let t=e.startsWith("0x")?e.slice(2):e,a=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)a[e/2]=Number.parseInt(t.substr(e,2),16);return a}(o),n=X(t,32),r=new TextEncoder().encode("EIP-7503"),s=(await en()+BigInt(e)*BigInt(10)**BigInt(18))%eg,l=0;for(;l<1e6;){s>=eg&&(s=BigInt(0));let i=X(s,32),c=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let n=new Uint8Array(t.reduce((e,t)=>e+t.length,0)),r=0;for(let e of t)n.set(e,r),r+=e.length;return n}(i,a,n,r),d="0x"+Array.from(c).map(e=>e.toString(16).padStart(2,"0")).join("");if((0,em.w)(d).slice(2).slice(0,4)==="0".repeat(4)){let a=function(e,t,a){try{let n=BigInt(t),r="0x"+eh.toString(16),s="0x"+e.toString(16),l="0x"+n.toString(16),o="0x"+a.toString(16),i=(0,eu.qw)([r,s,l,o]),c=X(BigInt(i),32).slice(0,20);return"0x"+Array.from(c).map(e=>e.toString(16).padStart(2,"0")).join("")}catch(e){throw console.error("Error deriving burn address:",e),Error("Failed to derive burn address")}}(s,o,t),n={index:e,burnKey:s.toString(),burnAddress:a};h(t=>{let a=[...t.filter(t=>t.index!==e),n].sort((e,t)=>e.index-t.index);return J(a),a}),setTimeout(()=>Q(a,e),100);return}s+=BigInt(1),++l%1e3==0&&await new Promise(e=>setTimeout(e,0))}throw Error("Could not find suitable burn key within ".concat(1e6," iterations for index ").concat(e))}catch(e){N(e instanceof Error?e.message:"An error occurred")}finally{x(!1)}}let ep=e=>{let t=g.find(t=>t.burnAddress===e),a=(null==t?void 0:t.balance)?Number.parseFloat(t.balance):0;F(e),W((null==t?void 0:t.burnKey)||""),z(a>0),G({stage:"confirm"}),A(!0),R("")},ef=async()=>{if(i&&T&&B){I(!0);try{let e=(0,O.fi)(T),t=await i.sendTransaction({to:B,value:e});await t.wait();let a=g.find(e=>e.burnAddress===B);a&&setTimeout(()=>Q(B,a.index),1e3),A(!1),R(""),null==s||s()}catch(e){N(e instanceof Error?e.message:"Failed to burn ETH")}finally{I(!1)}}},ex=async()=>{G({stage:"generate"}),console.log("[v0] Generating proof with endpoint: ".concat(L)),console.log("[v0] Generating proof with request:",JSON.stringify({burnKey:H,receiverAddress:o,fee:0},null,2)),await new Promise(e=>setTimeout(e,2e3));let e={proof:"0x"+Array.from({length:64},()=>Math.floor(16*Math.random()).toString(16)).join(""),publicSignals:["0x123","0x456","0x789"]};console.log("[v0] Generated proof:",JSON.stringify(e,null,2)),G({stage:"submit",proof:e})},eb=async()=>{console.log("[v0] Submitting proof:",JSON.stringify(U.proof,null,2)),await new Promise(e=>setTimeout(e,1500)),console.log("[v0] Proof submitted successfully!"),G({stage:"complete"}),setTimeout(()=>{A(!1),G({stage:"confirm"})},2e3)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(_.Vq,{open:c,onOpenChange:u,children:[(0,n.jsx)(_.hg,{asChild:!0,children:r}),(0,n.jsxs)(_.cZ,{className:"bg-green-950/95 border-green-800 text-white max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,n.jsxs)(_.fK,{children:[(0,n.jsxs)(_.$N,{className:"text-2xl text-green-300 flex items-center gap-2",children:[(0,n.jsx)(m.Z,{className:"w-6 h-6"}),"Burn Addresses"]}),(0,n.jsx)(_.Be,{className:"text-gray-400",children:"Manage your burn addresses for EIP-7503 transactions. Generate new addresses or use existing ones to burn ETH."})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)(l.z,{onClick:()=>{g.forEach(e=>{Q(e.burnAddress,e.index)})},size:"sm",variant:"outline",className:"border-green-600 text-green-300 hover:bg-green-900/50 bg-transparent",disabled:S.size>0,children:[(0,n.jsx)(d.Z,{className:"w-4 h-4 mr-2 ".concat(S.size>0?"animate-spin":"")}),"Refresh Balances"]}),(0,n.jsx)(l.z,{onClick:()=>{er(b),y(e=>e+1)},disabled:p||!o,size:"sm",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eo.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating #",b,"..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ei.Z,{className:"mr-2 h-4 w-4"}),"Generate Address #",b]})})]}),g.length>0?(0,n.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:g.map(e=>(0,n.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-950/40 border border-green-800 rounded-lg",children:[(0,n.jsxs)("span",{className:"text-sm font-medium min-w-[60px] text-green-300",children:["#",e.index]}),(0,n.jsx)("span",{className:"text-xs text-gray-300 flex-1 font-mono bg-black/30 px-2 py-1 rounded",children:e.burnAddress}),(0,n.jsxs)("span",{className:"text-xs text-gray-400 min-w-[120px]",children:["Balance:"," ",S.has(e.index)?(0,n.jsx)(eo.Z,{className:"h-3 w-3 animate-spin inline text-green-400"}):e.balance?(0,n.jsxs)("span",{className:"text-green-300 font-medium",children:[Number.parseFloat(e.balance).toFixed(6)," ETH"]}):"Unknown"]}),(0,n.jsx)(l.z,{size:"sm",variant:"outline",onClick:()=>ep(e.burnAddress),className:"ml-2 border-green-600 text-green-300 hover:bg-green-900/50 bg-transparent",children:e.balance&&Number.parseFloat(e.balance)>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ec.Z,{className:"h-3 w-3 mr-1 text-green-400"}),"Mint"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.Z,{className:"h-3 w-3 mr-1 text-yellow-400"}),"Burn"]})})]},e.index))}):(0,n.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,n.jsx)(m.Z,{className:"w-12 h-12 mx-auto mb-4 text-green-600"}),(0,n.jsx)("p",{children:"No burn addresses generated yet."}),(0,n.jsx)("p",{className:"text-sm",children:'Click "Generate Address" to create your first burn address.'})]}),w&&(0,n.jsx)($,{className:"bg-red-900/30 border-red-700",children:(0,n.jsx)(D,{className:"text-red-300",children:w})})]})]})]}),(0,n.jsx)(_.Vq,{open:k,onOpenChange:A,children:(0,n.jsxs)(_.cZ,{className:"bg-green-950/95 border-green-800 text-white",children:[(0,n.jsxs)(_.fK,{children:[(0,n.jsx)(_.$N,{className:"text-green-300",children:Z?"Mint BETH":"Burn ETH"}),(0,n.jsx)(_.Be,{className:"text-gray-400",children:Z?(0,n.jsxs)(n.Fragment,{children:["confirm"===U.stage&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("strong",{children:[(null===(t=g.find(e=>e.burnAddress===B))||void 0===t?void 0:t.balance)||"0"," BETH"]})," ","is going to be minted for address ",(0,n.jsx)("strong",{children:o}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"The process has two stages:",(0,n.jsx)("br",{}),"1. Generate proof",(0,n.jsx)("br",{}),"2. Submit proof"]}),"generate"===U.stage&&"Generating cryptographic proof...","submit"===U.stage&&"Proof generated successfully. Ready to submit.","complete"===U.stage&&"BETH minted successfully!"]}):"Send ETH to the burn address: ".concat(B)})]}),Z?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)($,{className:"bg-yellow-900/30 border-yellow-600",children:(0,n.jsxs)(D,{className:"text-yellow-200",children:[(0,n.jsx)("strong",{children:"Privacy Notice:"})," If you want to use the privacy aspects of this protocol, it's mandatory to broadcast the proof submission transaction through a different wallet. If you just want to get BETH for WORM mining, using the same wallet is okay."]})}),(0,n.jsxs)("div",{className:"p-4 bg-green-950/40 border border-green-800 rounded-lg",children:[(0,n.jsxs)("p",{className:"text-sm text-white",children:[(0,n.jsx)("strong",{children:"Burn Address:"})," ",(0,n.jsx)("span",{className:"font-mono text-xs",children:B})]}),(0,n.jsxs)("p",{className:"text-sm text-white",children:[(0,n.jsx)("strong",{children:"Available Balance:"})," ",(0,n.jsxs)("span",{className:"text-green-300 font-medium",children:[(null===(a=g.find(e=>e.burnAddress===B))||void 0===a?void 0:a.balance)||"0"," ETH"]})]})]}),"confirm"===U.stage&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(q,{htmlFor:"endpoint",className:"text-white",children:"Proving Endpoint"}),(0,n.jsxs)(ee,{value:L,onValueChange:V,children:[(0,n.jsx)(ea,{className:"bg-green-950/60 border-green-700 text-white",children:(0,n.jsx)(et,{placeholder:"Select proving endpoint"})}),(0,n.jsx)(es,{className:"bg-green-950 border-green-700",children:["http://12.23.34.45:8000/prove","http://45.34.23.12:8000/prove"].map(e=>(0,n.jsx)(el,{value:e,children:e},e))})]})]}),"submit"===U.stage&&(0,n.jsxs)("div",{className:"p-3 bg-green-950/40 border border-green-800 rounded text-xs",children:[(0,n.jsx)("strong",{className:"text-white",children:"Proof Generated:"}),(0,n.jsx)("pre",{className:"mt-1 text-xs overflow-x-auto text-gray-300",children:JSON.stringify(U.proof,null,2)})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(l.z,{variant:"outline",onClick:()=>A(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800 bg-transparent",children:"Cancel"}),"confirm"===U.stage&&(0,n.jsx)(l.z,{onClick:ex,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:"Generate proof"}),"generate"===U.stage&&(0,n.jsxs)(l.z,{disabled:!0,className:"flex-1 bg-gray-600",children:[(0,n.jsx)(eo.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating proof..."]}),"submit"===U.stage&&(0,n.jsx)(l.z,{onClick:eb,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:"Submit proof"}),"complete"===U.stage&&(0,n.jsxs)(l.z,{disabled:!0,className:"flex-1 bg-green-600",children:[(0,n.jsx)(ec.Z,{className:"mr-2 h-4 w-4"}),"Minted successfully!"]})]})]}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(q,{htmlFor:"burnAmount",className:"text-white",children:"Amount (ETH)"}),(0,n.jsx)(P,{id:"burnAmount",type:"number",placeholder:"0.0",value:T,onChange:e=>R(e.target.value),min:"0",max:"1",step:"0.001",className:"bg-green-950/60 border-green-700 text-white placeholder:text-gray-400"}),(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Maximum: 1 ETH"})]}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)(l.z,{variant:"outline",onClick:()=>A(!1),className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800 bg-transparent",children:"Cancel"}),(0,n.jsx)(l.z,{onClick:ef,disabled:!T||0>=Number.parseFloat(T)||Number.parseFloat(T)>10||M,className:"flex-1 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold",children:M?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eo.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Burning..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Burn ",T," ETH"]})})]})]})]})})]})}function ef(){let{isConnected:e,address:t,connectWallet:a,disconnectWallet:x,error:y}=v(),{bethBalance:w,wormBalance:N,loading:j,error:E}=function(){let{isConnected:e,address:t,provider:a}=v(),{networkConfig:n}=(0,b.L)(),[r,s]=(0,f.useState)("0.0000"),[l,o]=(0,f.useState)("0.0000"),[i,c]=(0,f.useState)(!1),[d,m]=(0,f.useState)(null),[u,g]=(0,f.useState)(null),h=[{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],p=async()=>{if(!e||!t||!a){s("0.0000"),o("0.0000");return}u&&u.abort();let r=new AbortController;g(r);try{c(!0),m(null),console.log("[v0] Fetching balances for address:",t),console.log("[v0] Using BETH contract:",n.contracts.beth),console.log("[v0] Using WORM contract:",n.contracts.worm);let e=new z.CH(n.contracts.beth,h,a),l=new z.CH(n.contracts.worm,h,a),[i,d]=await Promise.all([a.getCode(n.contracts.beth),a.getCode(n.contracts.worm)]);"0x"===i&&(console.warn("[v0] BETH contract not found at address:",n.contracts.beth),s("0.0000")),"0x"===d&&(console.warn("[v0] WORM contract not found at address:",n.contracts.worm),o("0.0000"));let u=[],g=[];if("0x"!==i&&(u.push(e.balanceOf(t)),g.push("beth")),"0x"!==d&&(u.push(l.balanceOf(t)),g.push("worm")),0===u.length){console.warn("[v0] No valid contracts found on this network"),s("0.0000"),o("0.0000");return}let p=Promise.all(u),f=new Promise((e,t)=>{setTimeout(()=>t(Error("Request timeout")),1e4)}),x=new Promise((e,t)=>{r.signal.addEventListener("abort",()=>{t(Error("Request cancelled"))})}),b=await Promise.race([p,f,x]);if(r.signal.aborted)return;let y=BigInt(0),w=BigInt(0),v=0;g.includes("beth")&&(y=b[v],v++),g.includes("worm")&&(w=b[v]);let N=O.dF(y),j=O.dF(w);s(Number.parseFloat(N).toFixed(4)),o(Number.parseFloat(j).toFixed(4)),console.log("[v0] Balances fetched - BETH:",N,"WORM:",j)}catch(e){var l,i;(null===(l=e.message)||void 0===l?void 0:l.includes("network changed"))||"NETWORK_ERROR"===e.code?(console.log("[v0] Network change detected during balance fetch, will retry"),s("0.0000"),o("0.0000")):"Request cancelled"===e.message||"Request timeout"===e.message?console.log("[v0] Balance fetch cancelled or timed out"):("BAD_DATA"===e.code||(null===(i=e.message)||void 0===i?void 0:i.includes("could not decode result data"))?console.warn("[v0] Contract call failed - contracts may not exist on this network:",e.message):(console.error("[v0] Error fetching balances:",e),m(e.message||"Failed to fetch balances")),s("0.0000"),o("0.0000"))}finally{c(!1),g(null)}};return(0,f.useEffect)(()=>{p()},[e,t,a,n]),(0,f.useEffect)(()=>{if(e&&t){let e=setInterval(p,3e4);return()=>clearInterval(e)}},[e,t]),(0,f.useEffect)(()=>()=>{u&&u.abort()},[]),{bethBalance:r,wormBalance:l,loading:i,error:d}}(),{currentEpoch:S}=function(){let[e,t]=(0,f.useState)(0),[a,n]=(0,f.useState)(!0),[r,s]=(0,f.useState)(null),{networkConfig:l}=(0,b.L)(),o=async()=>{try{n(!0),s(null);let e=l.rpcUrls[0];console.log("[v0] Fetching current epoch from:",e),console.log("[v0] Using WORM contract:",l.contracts.worm);let a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_call",params:[{to:l.contracts.worm,data:"0x76671808"},"latest"],id:1})}),r=await a.json();if(r.error)throw Error(r.error.message);let o=Number.parseInt(r.result,16);t(o),console.log("[v0] Current epoch:",o)}catch(e){console.error("[v0] Error fetching current epoch:",e),s(e instanceof Error?e.message:"Failed to fetch current epoch")}finally{n(!1)}};return(0,f.useEffect)(()=>{o();let e=setInterval(o,3e4);return()=>clearInterval(e)},[l]),{currentEpoch:e,loading:a,error:r,refetch:o}}();return(0,n.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,n.jsxs)("div",{className:"container mx-auto px-6 py-6 flex justify-between items-center",children:[(0,n.jsxs)(p.default,{href:"/",className:"inline-flex items-center gap-2 text-green-300 hover:text-green-200 transition-colors",children:[(0,n.jsx)(o.Z,{className:"w-4 h-4"}),"Back to Home"]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(Z,{}),y&&(0,n.jsxs)("div",{className:"flex items-center gap-2 text-red-300 text-sm",children:[(0,n.jsx)(i.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:y})]}),e?(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"text-sm font-mono text-green-300 bg-green-950/60 px-3 py-1 rounded-lg",children:"".concat(t.slice(0,6),"...").concat(t.slice(-4))}),(0,n.jsx)(l.z,{size:"sm",variant:"outline",onClick:x,className:"border-red-600 text-red-300 hover:bg-red-900/50 bg-transparent",children:"Disconnect"})]}):(0,n.jsxs)(l.z,{onClick:a,size:"sm",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-black font-semibold border-0",children:[(0,n.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Connect Wallet"}),(0,n.jsx)("span",{className:"sm:hidden",children:"Connect"})]})]})]}),(0,n.jsx)("section",{className:"py-1 bg-green-950/10",children:(0,n.jsx)("div",{className:"container mx-auto px-6",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 transition-opacity duration-300 ".concat(e?"opacity-100":"opacity-50"),children:[(0,n.jsxs)(s.Zb,{className:"bg-green-950/40 border-green-800",children:[(0,n.jsxs)(s.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(s.ll,{className:"text-sm font-medium text-green-300",children:"BETH Balance"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[j&&(0,n.jsx)(d.Z,{className:"h-3 w-3 text-green-400 animate-spin"}),(0,n.jsx)(m.Z,{className:"h-4 w-4 text-yellow-400"})]})]}),(0,n.jsxs)(s.aY,{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-xl font-bold text-yellow-300 font-mono",children:e?j?"...":w:"---.----"}),(0,n.jsx)("p",{className:"text-xs text-gray-400",children:"Burned ETH tokens"}),E&&(0,n.jsx)("p",{className:"text-xs text-red-400",children:"Error loading balance"}),(0,n.jsx)(ep,{onBurnComplete:()=>{console.log("[v0] Burn completed, balances will refresh automatically")},children:(0,n.jsxs)(l.z,{size:"sm",variant:"outline",className:"border-green-600 text-green-300 hover:bg-green-900/50 bg-transparent w-full",disabled:!0,children:["Burn ETH",(0,n.jsx)(m.Z,{className:"ml-2 w-4 h-4"})]})}),(0,n.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"Max 1 ETH per transaction"})]})]}),(0,n.jsxs)(s.Zb,{className:"bg-green-950/40 border-green-800",children:[(0,n.jsxs)(s.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(s.ll,{className:"text-sm font-medium text-green-300",children:"WORM Balance"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[j&&(0,n.jsx)(d.Z,{className:"h-3 w-3 text-green-400 animate-spin"}),(0,n.jsx)(u.Z,{className:"h-4 w-4 text-green-400"})]})]}),(0,n.jsxs)(s.aY,{className:"space-y-3",children:[(0,n.jsx)("div",{className:"text-xl font-bold text-green-300 font-mono",children:e?j?"...":N:"---.----"}),(0,n.jsx)("p",{className:"text-xs text-gray-400",children:"Mined WORM tokens"}),E&&(0,n.jsx)("p",{className:"text-xs text-red-400",children:"Error loading balance"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsx)(K,{bethBalance:w,currentEpoch:S,children:(0,n.jsxs)(l.z,{size:"sm",variant:"outline",className:"border-blue-600 text-blue-300 hover:bg-blue-900/50 bg-transparent",disabled:!e,children:[(0,n.jsx)(g.Z,{className:"w-3 h-3 mr-1"}),"Participate"]})}),(0,n.jsx)(J,{currentEpoch:S,children:(0,n.jsxs)(l.z,{size:"sm",variant:"outline",className:"border-purple-600 text-purple-300 hover:bg-purple-900/50 bg-transparent",disabled:!e,children:[(0,n.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"Claim"]})})]})]})]})]})})})}),(0,n.jsx)(r.BurnActivity,{})]})}function ex(){return(0,n.jsx)(b.NetworkProvider,{children:(0,n.jsx)(w,{children:(0,n.jsx)(ef,{})})})}}},function(e){e.O(0,[226,715,140,971,117,744],function(){return e(e.s=6270)}),_N_E=e.O()}]);